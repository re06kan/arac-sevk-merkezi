import{W as A,f as S,zd as _}from"./chunk-DASZUGZO.js";var f=(()=>{class i{_listeners=[];notify(s,t){for(let r of this._listeners)r(s,t)}listen(s){return this._listeners.push(s),()=>{this._listeners=this._listeners.filter(t=>s!==t)}}ngOnDestroy(){this._listeners=[]}static \u0275fac=function(t){return new(t||i)};static \u0275prov=A({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var m=class{applyChanges(e,s,t,r,a){e.forEachOperation((o,l,E)=>{let n,h;if(o.previousIndex==null){let c=t(o,l,E);n=s.createEmbeddedView(c.templateRef,c.context,c.index),h=_.INSERTED}else E==null?(s.remove(l),h=_.REMOVED):(n=s.get(l),s.move(n,E),h=_.MOVED);a&&a({context:n?.context,operation:h,record:o})})}detach(){}};var d=class{_multiple;_emitChanges;compareWith;_selection=new Set;_deselectedToEmit=[];_selectedToEmit=[];_selected;get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}changed=new S;constructor(e=!1,s,t=!0,r){this._multiple=e,this._emitChanges=t,this.compareWith=r,s&&s.length&&(e?s.forEach(a=>this._markSelected(a)):this._markSelected(s[0]),this._selectedToEmit.length=0)}select(...e){this._verifyValueAssignment(e),e.forEach(t=>this._markSelected(t));let s=this._hasQueuedChanges();return this._emitChangeEvent(),s}deselect(...e){this._verifyValueAssignment(e),e.forEach(t=>this._unmarkSelected(t));let s=this._hasQueuedChanges();return this._emitChangeEvent(),s}setSelection(...e){this._verifyValueAssignment(e);let s=this.selected,t=new Set(e.map(a=>this._getConcreteValue(a)));e.forEach(a=>this._markSelected(a)),s.filter(a=>!t.has(this._getConcreteValue(a,t))).forEach(a=>this._unmarkSelected(a));let r=this._hasQueuedChanges();return this._emitChangeEvent(),r}toggle(e){return this.isSelected(e)?this.deselect(e):this.select(e)}clear(e=!0){this._unmarkAll();let s=this._hasQueuedChanges();return e&&this._emitChangeEvent(),s}isSelected(e){return this._selection.has(this._getConcreteValue(e))}isEmpty(){return this._selection.size===0}hasValue(){return!this.isEmpty()}sort(e){this._multiple&&this.selected&&this._selected.sort(e)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(e){e=this._getConcreteValue(e),this.isSelected(e)||(this._multiple||this._unmarkAll(),this.isSelected(e)||this._selection.add(e),this._emitChanges&&this._selectedToEmit.push(e))}_unmarkSelected(e){e=this._getConcreteValue(e),this.isSelected(e)&&(this._selection.delete(e),this._emitChanges&&this._deselectedToEmit.push(e))}_unmarkAll(){this.isEmpty()||this._selection.forEach(e=>this._unmarkSelected(e))}_verifyValueAssignment(e){e.length>1&&this._multiple}_hasQueuedChanges(){return!!(this._deselectedToEmit.length||this._selectedToEmit.length)}_getConcreteValue(e,s){if(this.compareWith){s=s??this._selection;for(let t of s)if(this.compareWith(e,t))return t;return e}else return e}};export{f as a,m as b,d as c};
